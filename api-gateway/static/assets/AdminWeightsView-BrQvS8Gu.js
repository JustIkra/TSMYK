import{O as S,m as f,Q as A,H as Oe,v as V,w as l,E as g,r as p,I as Ze,o as c,a as i,f as t,J as je,e as u,u as _,a4 as he,M as Ge,c as m,a5 as Xe,F as P,C as le,K as ye,B as v,_ as we,Z as ae,x as C,a6 as be,z as ke,a3 as Ve,a0 as Ye,a7 as et,a8 as tt,N as lt}from"./index-DwKnS0nx.js";import{A as at}from"./AppLayout-CGVE8hgK.js";import{m as st,g as it}from"./metricNames-C7Olx0YO.js";import{b as ot}from"./dateFormat-Bky3s5gS.js";import{_ as nt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={async list(){return(await S.get("/prof-activities")).data.activities||[]},async create(h){return(await S.post("/prof-activities",h)).data},async update(h,k){return(await S.put(`/prof-activities/${h}`,k)).data},async delete(h){await S.delete(`/prof-activities/${h}`)}},se={async upload(h){return(await S.post("/admin/weights/upload",h)).data},async update(h,k){return(await S.put(`/admin/weights/${h}`,k)).data},async list(h=null){const k=h?{prof_activity_code:h}:{};return(await S.get("/admin/weights",{params:k})).data}},rt={class:"admin-weights-view"},dt={class:"header-content"},ut={class:"header-buttons"},ct={class:"areas-container"},vt={key:2,class:"areas-grid"},pt={class:"area-header"},mt={class:"area-title"},_t={key:0,class:"area-description"},ft={key:0,class:"no-table"},gt={key:1,class:"table-info"},ht={class:"table-stats"},yt={class:"stat-item"},wt={class:"stat-item"},bt={class:"stat-item"},kt={class:"table-actions"},Vt={class:"selected-area"},xt={class:"area-name"},Ft={class:"weight-sum-indicator"},Ct={class:"weight-sum-header"},zt={class:"weight-sum-value"},Tt={class:"weights-editor-grid"},$t={class:"competency-list"},At={class:"competency-list-header"},Mt={class:"competency-list-items"},Wt=["onClick"],Ut={class:"competency-item-header"},Dt={key:0,class:"critical-icon",title:"Критическая компетенция"},St={class:"competency-name"},Nt={class:"competency-weight"},Bt={class:"competency-percent"},Pt={key:0,class:"competency-list-empty"},qt={class:"competency-detail"},Lt={class:"detail-header"},Et={class:"detail-title"},It={class:"detail-section"},Rt={key:0,class:"metric-code-hint"},Qt={class:"detail-section"},Ht={class:"detail-label-row"},Jt={class:"weight-actions"},Kt={class:"remaining-hint"},Ot={class:"detail-section"},Zt={class:"critical-toggle"},jt={class:"critical-toggle-label"},Gt={key:0,class:"critical-params"},Xt={class:"critical-param"},Yt={class:"detail-label-row"},el={class:"critical-param"},tl={class:"detail-label-row"},ll={class:"threshold-value"},al={class:"critical-hint"},sl={key:1,class:"detail-empty"},il={key:0},ol={class:"metric-cell"},nl={key:0,style:{"margin-top":"20px"}},rl={__name:"AdminWeightsView",setup(h){const k=f(!1),z=f(!1),E=f(""),T=f(null),ie=f([]),J=f([]),I=f([]),oe=new Set,K=(s,e)=>{const r=s?.code||e,d=r&&oe.has(r)?{warn:()=>{}}:{warn:F=>{r&&oe.add(r),console.warn(F)}};return it(s,r,d)},N=f(!1),R=f(!1),M=f(!1),b=f(null),W=f(null),x=f(null),n=f(null),xe=f(null),o=f({prof_activity_code:"",weights:[],metadata:{description:""}}),y=f({code:"",name:"",description:""}),ne=A(()=>{const s=J.value.map(r=>{const d=ie.value.find(F=>F.prof_activity_code===r.code);return{...r,weightTable:d||null}});if(!E.value)return s;const e=E.value.toLowerCase();return s.filter(r=>r.name.toLowerCase().includes(e)||r.description&&r.description.toLowerCase().includes(e))}),O=A(()=>{const s=J.value.find(e=>e.code===o.value.prof_activity_code);return s?s.name:""}),Fe=A(()=>W.value?`Редактировать весовую таблицу: ${O.value}`:`Создать весовую таблицу: ${O.value}`),w=A(()=>o.value.weights.reduce((s,e)=>s+(parseFloat(e.weight)||0),0)),Ce=A(()=>Math.abs(w.value-1)<1e-4&&o.value.weights.length>0);A(()=>Math.abs(w.value-1)<1e-4?"success":w.value<1?"warning":"error");const ze=A(()=>Math.abs(w.value-1)<1e-4?"success":w.value>1?"exception":""),re=A(()=>Math.max(0,1-w.value)),Z=async()=>{try{const s=await se.list();ie.value=s}catch(s){throw console.error("Failed to load weight tables:",s),T.value="Ошибка загрузки весовых таблиц",g.error("Ошибка загрузки весовых таблиц"),s}},Te=s=>{W.value=null,n.value=null,o.value={prof_activity_code:s.code,weights:[],metadata:{description:""}},N.value=!0},j=async()=>{try{const s=await H.list();J.value=s}catch(s){throw console.error("Failed to load prof activities:",s),T.value="Ошибка загрузки профессиональных областей",g.error("Ошибка загрузки профессиональных областей"),s}},$e=async()=>{try{const s=await st.listMetricDefs(!0);I.value=s.items||[]}catch(s){throw console.error("Failed to load metrics:",s),T.value="Ошибка загрузки метрик",g.error("Ошибка загрузки метрик"),s}},de=s=>{W.value=s,n.value=s.weights.length>0?0:null,o.value={prof_activity_code:s.prof_activity_code,weights:s.weights.map(e=>({metric_code:e.metric_code,weight:parseFloat(e.weight),is_critical:e.is_critical||!1,penalty:parseFloat(e.penalty)||0,threshold:parseFloat(e.threshold)||6})),metadata:s.metadata||{description:""}},N.value=!0},Ae=()=>{o.value.weights.push({metric_code:"",weight:0,is_critical:!1,penalty:0,threshold:6}),n.value=o.value.weights.length-1},Me=s=>{n.value=s},ue=s=>{if(!s.metric_code)return"Не выбрана";const e=I.value.find(r=>r.code===s.metric_code);return K(e,s.metric_code)},We=()=>{if(n.value!==null&&o.value.weights[n.value]){const s=parseFloat(o.value.weights[n.value].weight)||0,e=1-w.value;o.value.weights[n.value].weight=Math.min(1,s+e)}},Ue=s=>{s.is_critical||(s.penalty=0,s.threshold=6)},De=s=>{o.value.weights.splice(s,1),n.value===s?n.value=o.value.weights.length>0?Math.min(s,o.value.weights.length-1):null:n.value!==null&&n.value>s&&n.value--},Se=async()=>{try{if(z.value=!0,!o.value.prof_activity_code){g.warning("Выберите профессиональную область");return}if(o.value.weights.length===0){g.warning("Добавьте хотя бы одну компетенцию");return}const s=o.value.weights.map(d=>d.metric_code);if(new Set(s.filter(d=>d)).size!==o.value.weights.length){g.warning("Компетенции должны быть уникальными");return}if(o.value.weights.some(d=>!d.metric_code)){g.warning("Все компетенции должны быть заполнены");return}const r={prof_activity_code:o.value.prof_activity_code,weights:o.value.weights.map(d=>({metric_code:d.metric_code,weight:parseFloat(d.weight),is_critical:d.is_critical||!1,penalty:d.is_critical&&parseFloat(d.penalty)||0,threshold:d.is_critical&&parseFloat(d.threshold)||6})),metadata:o.value.metadata.description?o.value.metadata:null};W.value?(await se.update(W.value.id,r),g.success("Изменения применены")):(await se.upload(r),g.success("Таблица создана")),N.value=!1,await Z()}catch(s){console.error("Failed to save weight table:",s),g.error(s.response?.data?.detail||"Ошибка сохранения таблицы")}finally{z.value=!1}},Ne=s=>{b.value=s,R.value=!0},ce=()=>{x.value=null,y.value={code:"",name:"",description:""},M.value=!0},Be=s=>{x.value=s,y.value={code:s.code,name:s.name,description:s.description||""},M.value=!0},Pe=async()=>{try{if(z.value=!0,!y.value.code||!y.value.name){g.warning("Заполните обязательные поля");return}x.value?(await H.update(x.value.id,{name:y.value.name,description:y.value.description}),g.success("Область обновлена")):(await H.create(y.value),g.success("Область создана")),M.value=!1,await j()}catch(s){console.error("Failed to save prof activity:",s),g.error(s.response?.data?.detail||"Ошибка сохранения области")}finally{z.value=!1}},qe=async()=>{try{await lt.confirm(`Удалить профессиональную область "${x.value.name}"? Это действие нельзя отменить.`,"Предупреждение",{confirmButtonText:"Удалить",cancelButtonText:"Отмена",type:"error"}),await H.delete(x.value.id),g.success("Область удалена"),M.value=!1,await j(),await Z()}catch(s){s!=="cancel"&&(console.error("Failed to delete prof activity:",s),g.error(s.response?.data?.detail||"Ошибка удаления области"))}},G=s=>s.weights.reduce((e,r)=>e+parseFloat(r.weight),0),ve=s=>{const e=G(s);return Math.abs(e-1)<1e-4?"success":"danger"},Le=s=>s.map(e=>{const r=I.value.find(d=>d.code===e.metric_code);return{...e,metric_name:K(r,e.metric_code),metric_code:e.metric_code,is_critical:e.is_critical||!1,penalty:e.penalty||0,threshold:e.threshold||6}}),pe=ot,me=async()=>{k.value=!0,T.value=null;try{await Promise.all([Z(),j(),$e()])}catch(s){console.error("Failed to load data:",s),T.value||(T.value="Не удалось загрузить данные")}finally{k.value=!1}};return Oe(async()=>{await me()}),(s,e)=>{const r=p("el-icon"),d=p("el-button"),F=p("el-card"),q=p("el-input"),Ee=p("el-result"),_e=p("el-empty"),B=p("el-tag"),$=p("el-text"),L=p("el-form-item"),Q=p("el-divider"),fe=p("el-progress"),Ie=p("el-option"),Re=p("el-select"),X=p("el-input-number"),Y=p("el-slider"),Qe=p("el-switch"),ge=p("el-form"),ee=p("el-dialog"),te=p("el-descriptions-item"),He=p("el-descriptions"),U=p("el-table-column"),Je=p("el-table"),Ke=Ze("loading");return c(),V(at,null,{default:l(()=>[i("div",rt,[t(F,{class:"header-card"},{default:l(()=>[i("div",dt,[e[23]||(e[23]=i("div",null,[i("h1",null,"Управление весовыми таблицами"),i("p",null,"Каждая профессиональная область имеет свою уникальную весовую таблицу")],-1)),i("div",ut,[t(d,{size:"large",type:"primary",onClick:ce},{default:l(()=>[t(r,null,{default:l(()=>[t(_(he))]),_:1}),e[22]||(e[22]=u(" Новая область ",-1))]),_:1})])])]),_:1}),t(F,{class:"search-card"},{default:l(()=>[t(q,{modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=a=>E.value=a),placeholder:"Поиск по названию профессиональной области...","prefix-icon":_(Ge),size:"large",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),je((c(),m("div",ct,[T.value?(c(),V(Ee,{key:0,icon:"error",title:"Ошибка загрузки","sub-title":T.value},{extra:l(()=>[t(d,{type:"primary",onClick:me},{default:l(()=>[t(r,null,{default:l(()=>[t(_(Xe))]),_:1}),e[24]||(e[24]=u(" Повторить ",-1))]),_:1})]),_:1},8,["sub-title"])):ne.value.length===0&&!k.value?(c(),V(_e,{key:1,description:"Нет профессиональных областей"},{default:l(()=>[t(d,{type:"primary",onClick:ce},{default:l(()=>[t(r,null,{default:l(()=>[t(_(he))]),_:1}),e[25]||(e[25]=u(" Создать первую область ",-1))]),_:1})]),_:1})):(c(),m("div",vt,[(c(!0),m(P,null,le(ne.value,a=>(c(),m("div",{key:a.id,class:"area-card-wrapper"},[t(F,{class:"area-card",shadow:"hover"},{header:l(()=>[i("div",pt,[i("div",mt,[t(r,{size:24,class:"icon-primary"},{default:l(()=>[t(_(be))]),_:1}),i("h3",null,v(a.name),1)]),t(d,{size:"small",circle:"",onClick:D=>Be(a)},{default:l(()=>[t(r,null,{default:l(()=>[t(_(ae))]),_:1})]),_:1},8,["onClick"])]),a.description?(c(),m("div",_t,v(a.description),1)):C("",!0)]),default:l(()=>[a.weightTable?(c(),m("div",gt,[i("div",ht,[i("div",yt,[e[27]||(e[27]=i("span",{class:"stat-label"},"Компетенций:",-1)),t(B,{size:"large"},{default:l(()=>[u(v(a.weightTable.weights.length),1)]),_:2},1024)]),i("div",wt,[e[28]||(e[28]=i("span",{class:"stat-label"},"Сумма весов:",-1)),t(B,{type:ve(a.weightTable),size:"large"},{default:l(()=>[u(v(G(a.weightTable).toFixed(4)),1)]),_:2},1032,["type"])]),i("div",bt,[e[29]||(e[29]=i("span",{class:"stat-label"},"Обновлена:",-1)),t($,{type:"info"},{default:l(()=>[u(v(_(pe)(a.weightTable.created_at)),1)]),_:2},1024)])]),i("div",kt,[t(d,{type:"info",onClick:D=>Ne(a.weightTable)},{default:l(()=>[t(r,null,{default:l(()=>[t(_(we))]),_:1}),e[30]||(e[30]=u(" Просмотр ",-1))]),_:1},8,["onClick"]),t(d,{type:"primary",onClick:D=>de(a.weightTable)},{default:l(()=>[t(r,null,{default:l(()=>[t(_(ae))]),_:1}),e[31]||(e[31]=u(" Редактировать ",-1))]),_:1},8,["onClick"])])])):(c(),m("div",ft,[t(_e,{description:"Весовая таблица не создана","image-size":80},{default:l(()=>[t(d,{type:"primary",onClick:D=>Te(a)},{default:l(()=>[t(r,null,{default:l(()=>[t(_(ye))]),_:1}),e[26]||(e[26]=u(" Создать таблицу ",-1))]),_:1},8,["onClick"])]),_:2},1024)]))]),_:2},1024)]))),128))]))])),[[Ke,k.value]])]),t(ee,{modelValue:N.value,"onUpdate:modelValue":e[13]||(e[13]=a=>N.value=a),title:Fe.value,width:"1100px","close-on-click-modal":!1,"align-center":"",class:"weights-dialog"},{footer:l(()=>[t(d,{onClick:e[12]||(e[12]=a=>N.value=!1)},{default:l(()=>[...e[46]||(e[46]=[u(" Отмена ",-1)])]),_:1}),t(d,{type:"primary",loading:z.value,disabled:!Ce.value,onClick:Se},{default:l(()=>[u(v(W.value?"Сохранить":"Создать"),1)]),_:1},8,["loading","disabled"])]),default:l(()=>[t(ge,{ref_key:"formRef",ref:xe,model:o.value,"label-width":"200px","label-position":"top"},{default:l(()=>[t(L,{label:"Профессиональная область",required:!W.value},{default:l(()=>[t(F,{shadow:"never",class:"area-display-card"},{default:l(()=>[i("div",Vt,[t(r,{size:20,class:"icon-primary"},{default:l(()=>[t(_(be))]),_:1}),i("span",xt,v(O.value),1)])]),_:1})]),_:1},8,["required"]),t(Q,{"content-position":"left"},{default:l(()=>[...e[32]||(e[32]=[u(" Компетенции и веса ",-1)])]),_:1}),i("div",Ft,[i("div",Ct,[e[33]||(e[33]=i("span",{class:"weight-sum-label"},"Сумма весов:",-1)),i("span",zt,v(w.value.toFixed(2))+" / 1.00",1),Math.abs(w.value-1)>=1e-4?(c(),m("span",{key:0,class:ke(["weight-sum-remaining",{"is-over":w.value>1}])},[w.value<1?(c(),m(P,{key:0},[u(" Осталось: "+v((1-w.value).toFixed(2)),1)],64)):(c(),m(P,{key:1},[u(" Превышение: "+v((w.value-1).toFixed(2)),1)],64))],2)):C("",!0)]),t(fe,{percentage:Math.min(w.value*100,100),"stroke-width":8,"show-text":!1,status:ze.value},null,8,["percentage","status"])]),i("div",Tt,[i("div",$t,[i("div",At,[i("span",null,"Компетенции ("+v(o.value.weights.length)+")",1)]),i("div",Mt,[(c(!0),m(P,null,le(o.value.weights,(a,D)=>(c(),m("div",{key:D,class:ke(["competency-list-item",{"is-selected":n.value===D}]),onClick:dl=>Me(D)},[i("div",Ut,[a.is_critical?(c(),m("span",Dt,[t(r,{color:"var(--color-danger)"},{default:l(()=>[t(_(Ve))]),_:1})])):C("",!0),i("span",St,v(ue(a)),1),i("span",Nt,v((parseFloat(a.weight)||0).toFixed(2)),1),i("span",Bt,"("+v(((parseFloat(a.weight)||0)*100).toFixed(0))+"%)",1)]),t(fe,{percentage:(parseFloat(a.weight)||0)*100,"stroke-width":4,"show-text":!1,color:a.is_critical?"var(--color-danger)":"var(--color-primary)"},null,8,["percentage","color"])],10,Wt))),128)),o.value.weights.length===0?(c(),m("div",Pt,[t($,{type:"info"},{default:l(()=>[...e[34]||(e[34]=[u(" Нет компетенций ",-1)])]),_:1})])):C("",!0)]),t(d,{type:"primary",plain:"",icon:_(ye),class:"add-competency-btn",onClick:Ae},{default:l(()=>[...e[35]||(e[35]=[u(" Добавить компетенцию ",-1)])]),_:1},8,["icon"])]),i("div",qt,[n.value!==null&&o.value.weights[n.value]?(c(),m(P,{key:0},[i("div",Lt,[i("h4",Et,v(ue(o.value.weights[n.value])||"Новая компетенция"),1),t(d,{type:"danger",icon:_(Ye),circle:"",size:"small",onClick:e[1]||(e[1]=a=>De(n.value))},null,8,["icon"])]),i("div",It,[e[36]||(e[36]=i("label",{class:"detail-label"},"Компетенция",-1)),t(Re,{modelValue:o.value.weights[n.value].metric_code,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.weights[n.value].metric_code=a),placeholder:"Поиск метрики...",filterable:"",class:"detail-select"},{default:l(()=>[(c(!0),m(P,null,le(I.value,a=>(c(),V(Ie,{key:a.code,label:`${K(a)} (${a.code})`,value:a.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o.value.weights[n.value].metric_code?(c(),m("div",Rt," Код: "+v(o.value.weights[n.value].metric_code),1)):C("",!0)]),i("div",Qt,[i("div",Ht,[e[37]||(e[37]=i("label",{class:"detail-label"},"Вес",-1)),t(X,{modelValue:o.value.weights[n.value].weight,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.weights[n.value].weight=a),min:0,max:1,step:.01,precision:2,size:"small",class:"weight-input"},null,8,["modelValue"])]),t(Y,{modelValue:o.value.weights[n.value].weight,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.weights[n.value].weight=a),min:0,max:1,step:.01,"show-tooltip":!1},null,8,["modelValue"]),i("div",Jt,[i("span",Kt,"Осталось распределить: "+v(re.value.toFixed(2)),1),re.value>0?(c(),V(d,{key:0,type:"primary",size:"small",text:"",onClick:We},{default:l(()=>[...e[38]||(e[38]=[u(" Заполнить остаток ",-1)])]),_:1})):C("",!0)])]),i("div",Ot,[i("div",Zt,[i("div",jt,[t(r,{color:"var(--color-danger)"},{default:l(()=>[t(_(Ve))]),_:1}),e[39]||(e[39]=i("span",null,"Критичность",-1))]),t(Qe,{modelValue:o.value.weights[n.value].is_critical,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.weights[n.value].is_critical=a),onChange:e[6]||(e[6]=a=>Ue(o.value.weights[n.value]))},null,8,["modelValue"])]),o.value.weights[n.value].is_critical?(c(),m("div",Gt,[i("div",Xt,[i("div",Yt,[e[40]||(e[40]=i("label",{class:"detail-label"},"Штраф за невыполнение",-1)),t(X,{modelValue:o.value.weights[n.value].penalty,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.weights[n.value].penalty=a),min:0,max:.99,step:.05,precision:2,size:"small",class:"penalty-input"},null,8,["modelValue"])]),t(Y,{modelValue:o.value.weights[n.value].penalty,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.weights[n.value].penalty=a),min:0,max:.99,step:.01,"show-tooltip":!1},null,8,["modelValue"])]),i("div",el,[i("div",tl,[e[42]||(e[42]=i("label",{class:"detail-label"},"Минимальный порог",-1)),i("div",ll,[t(X,{modelValue:o.value.weights[n.value].threshold,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.weights[n.value].threshold=a),min:1,max:10,step:.5,precision:1,size:"small",class:"threshold-input"},null,8,["modelValue"]),e[41]||(e[41]=i("span",{class:"threshold-unit"},"балл.",-1))])]),t(Y,{modelValue:o.value.weights[n.value].threshold,"onUpdate:modelValue":e[10]||(e[10]=a=>o.value.weights[n.value].threshold=a),min:1,max:10,step:.5,"show-tooltip":!1},null,8,["modelValue"])]),i("div",al,[t(r,null,{default:l(()=>[t(_(et))]),_:1}),e[43]||(e[43]=i("span",null,"Штраф применяется, если оценка ниже порога",-1))])])):C("",!0)])],64)):(c(),m("div",sl,[t(r,{size:48,color:"var(--color-gray-400)"},{default:l(()=>[t(_(tt))]),_:1}),e[44]||(e[44]=i("p",null,"Выберите компетенцию для редактирования",-1)),e[45]||(e[45]=i("p",{class:"detail-empty-hint"}," или добавьте новую ",-1))]))])]),t(Q),t(L,{label:"Метаданные (опционально)"},{default:l(()=>[t(q,{modelValue:o.value.metadata.description,"onUpdate:modelValue":e[11]||(e[11]=a=>o.value.metadata.description=a),type:"textarea",rows:3,placeholder:"Описание версии таблицы, примечания и т.д."},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(ee,{modelValue:R.value,"onUpdate:modelValue":e[16]||(e[16]=a=>R.value=a),title:`Весовая таблица: ${b.value?.prof_activity_name}`,width:"900px","align-center":""},{footer:l(()=>[t(d,{size:"large",onClick:e[14]||(e[14]=a=>R.value=!1)},{default:l(()=>[...e[53]||(e[53]=[u(" Закрыть ",-1)])]),_:1}),t(d,{type:"primary",size:"large",onClick:e[15]||(e[15]=a=>de(b.value))},{default:l(()=>[t(r,null,{default:l(()=>[t(_(ae))]),_:1}),e[54]||(e[54]=u(" Редактировать ",-1))]),_:1})]),default:l(()=>[b.value?(c(),m("div",il,[t(F,{shadow:"never",class:"table-summary-card"},{default:l(()=>[t(He,{column:2,border:""},{default:l(()=>[t(te,{label:"Профессиональная область",span:2},{default:l(()=>[u(v(b.value.prof_activity_name),1)]),_:1}),t(te,{label:"Создана"},{default:l(()=>[u(v(_(pe)(b.value.created_at)),1)]),_:1}),t(te,{label:"Сумма весов"},{default:l(()=>[t(B,{type:ve(b.value),size:"large"},{default:l(()=>[u(v(G(b.value).toFixed(4)),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1}),t(Q,{"content-position":"left"},{default:l(()=>[t(r,null,{default:l(()=>[t(_(we))]),_:1}),u(" Компетенции ("+v(b.value.weights.length)+") ",1)]),_:1}),t(Je,{data:Le(b.value.weights),stripe:"","max-height":"500",size:"large","table-layout":"fixed"},{default:l(()=>[t(U,{type:"index",label:"#",width:"50",align:"center"}),t(U,{label:"Метрика","min-width":"200"},{default:l(({row:a})=>[i("div",ol,[i("strong",null,v(a.metric_name),1),e[47]||(e[47]=i("br",null,null,-1)),t($,{size:"small",type:"info"},{default:l(()=>[u(v(a.metric_code),1)]),_:2},1024)])]),_:1}),t(U,{prop:"weight",label:"Вес",width:"100",align:"center"},{default:l(({row:a})=>[t(B,{size:"large"},{default:l(()=>[u(v(parseFloat(a.weight).toFixed(2)),1)]),_:2},1024)]),_:1}),t(U,{label:"%",width:"80",align:"center"},{default:l(({row:a})=>[t($,{type:"info"},{default:l(()=>[u(v((parseFloat(a.weight)*100).toFixed(0))+"% ",1)]),_:2},1024)]),_:1}),t(U,{label:"Критическая",width:"110",align:"center"},{default:l(({row:a})=>[a.is_critical?(c(),V(B,{key:0,type:"danger",size:"small"},{default:l(()=>[...e[48]||(e[48]=[u(" Да ",-1)])]),_:1})):(c(),V($,{key:1,type:"info",size:"small"},{default:l(()=>[...e[49]||(e[49]=[u(" — ",-1)])]),_:1}))]),_:1}),t(U,{label:"Штраф",width:"90",align:"center"},{default:l(({row:a})=>[a.is_critical&&parseFloat(a.penalty)>0?(c(),V(B,{key:0,type:"warning",size:"small"},{default:l(()=>[u(v(parseFloat(a.penalty).toFixed(2)),1)]),_:2},1024)):(c(),V($,{key:1,type:"info",size:"small"},{default:l(()=>[...e[50]||(e[50]=[u(" — ",-1)])]),_:1}))]),_:1}),t(U,{label:"Порог",width:"80",align:"center"},{default:l(({row:a})=>[a.is_critical?(c(),V($,{key:0,size:"small"},{default:l(()=>[u(" < "+v(parseFloat(a.threshold).toFixed(1)),1)]),_:2},1024)):(c(),V($,{key:1,type:"info",size:"small"},{default:l(()=>[...e[51]||(e[51]=[u(" — ",-1)])]),_:1}))]),_:1})]),_:1},8,["data"]),b.value.metadata&&b.value.metadata.description?(c(),m("div",nl,[t(Q,{"content-position":"left"},{default:l(()=>[...e[52]||(e[52]=[u(" Описание ",-1)])]),_:1}),t(F,{shadow:"never",class:"metadata-card"},{default:l(()=>[u(v(b.value.metadata.description),1)]),_:1})])):C("",!0)])):C("",!0)]),_:1},8,["modelValue","title"]),t(ee,{modelValue:M.value,"onUpdate:modelValue":e[21]||(e[21]=a=>M.value=a),title:x.value?"Редактировать область":"Создать область",width:"600px"},{footer:l(()=>[t(d,{onClick:e[20]||(e[20]=a=>M.value=!1)},{default:l(()=>[...e[55]||(e[55]=[u(" Отмена ",-1)])]),_:1}),x.value?(c(),V(d,{key:0,type:"danger",onClick:qe},{default:l(()=>[...e[56]||(e[56]=[u(" Удалить ",-1)])]),_:1})):C("",!0),t(d,{type:"primary",loading:z.value,onClick:Pe},{default:l(()=>[u(v(x.value?"Сохранить":"Создать"),1)]),_:1},8,["loading"])]),default:l(()=>[t(ge,{model:y.value,"label-width":"120px"},{default:l(()=>[t(L,{label:"Код",required:""},{default:l(()=>[t(q,{modelValue:y.value.code,"onUpdate:modelValue":e[17]||(e[17]=a=>y.value.code=a),disabled:!!x.value,placeholder:"meeting_facilitation"},null,8,["modelValue","disabled"])]),_:1}),t(L,{label:"Название",required:""},{default:l(()=>[t(q,{modelValue:y.value.name,"onUpdate:modelValue":e[18]||(e[18]=a=>y.value.name=a),placeholder:"Проведение совещаний"},null,8,["modelValue"])]),_:1}),t(L,{label:"Описание"},{default:l(()=>[t(q,{modelValue:y.value.description,"onUpdate:modelValue":e[19]||(e[19]=a=>y.value.description=a),type:"textarea",rows:3,placeholder:"Описание профессиональной области"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1})}}},_l=nt(rl,[["__scopeId","data-v-775204d6"]]);export{_l as default};
