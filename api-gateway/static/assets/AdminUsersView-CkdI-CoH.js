import{A as D}from"./AppLayout-Bx_XUfGp.js";import{N as y,a2 as E,m as g,D as U,H as C,E as v,v as _,w as s,r as d,I as S,o as m,a as u,d as i,J as V,B as h,u as f,f as w}from"./index-B8jYj9uY.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const b={async getPendingUsers(){return(await y.get("/admin/pending-users")).data},async approveUser(r){return(await y.post(`/admin/approve/${r}`)).data}},N=E("admin",()=>{const r=g([]),e=g(!1),o=g(null);async function c(){e.value=!0,o.value=null;try{const a=await b.getPendingUsers();return r.value=a,a}catch(a){const t=U(a,"Ошибка загрузки пользователей");throw o.value=t.message,a.normalizedError=t,a}finally{e.value=!1}}async function l(a){e.value=!0,o.value=null;try{const t=await b.approveUser(a);return r.value=r.value.filter(n=>n.id!==a),t}catch(t){const n=U(t,"Ошибка одобрения пользователя");throw o.value=n.message,t.normalizedError=n,t}finally{e.value=!1}}return{pendingUsers:r,loading:e,error:o,fetchPendingUsers:c,approveUser:l}}),P={class:"admin-users-view"},$={class:"actions-group"},L={__name:"AdminUsersView",setup(r){const e=N(),o=async c=>{try{await e.approveUser(c.id),v.success(`Пользователь ${c.email} одобрен`)}catch{v.error(e.error||"Ошибка одобрения пользователя")}};return C(async()=>{try{await e.fetchPendingUsers()}catch{v.error("Ошибка загрузки пользователей")}}),(c,l)=>{const a=d("el-card"),t=d("el-empty"),n=d("el-table-column"),A=d("el-tag"),k=d("el-button"),x=d("el-table"),z=S("loading");return m(),_(D,null,{default:s(()=>[u("div",P,[i(a,{class:"header-card"},{default:s(()=>[...l[0]||(l[0]=[u("h1",null,"Управление пользователями",-1),u("p",null,"Одобрение новых пользователей системы",-1)])]),_:1}),V((m(),_(a,{class:"users-card"},{default:s(()=>[u("h3",null,"Ожидают одобрения ("+h(f(e).pendingUsers.length)+")",1),f(e).pendingUsers.length===0?(m(),_(t,{key:0,description:"Нет пользователей, ожидающих одобрения"})):(m(),_(x,{key:1,data:f(e).pendingUsers,stripe:""},{default:s(()=>[i(n,{prop:"email",label:"Email","min-width":"250"}),i(n,{label:"Статус",width:"120"},{default:s(({row:p})=>[i(A,{type:"warning"},{default:s(()=>[w(h(p.status),1)]),_:2},1024)]),_:1}),i(n,{prop:"created_at",label:"Дата регистрации",width:"180"},{default:s(({row:p})=>[w(h(new Date(p.created_at).toLocaleDateString("ru-RU")),1)]),_:1}),i(n,{label:"Действия",width:"150",fixed:"right"},{default:s(({row:p})=>[u("div",$,[i(k,{type:"success",size:"small",onClick:M=>o(p)},{default:s(()=>[...l[1]||(l[1]=[w(" Одобрить ",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"]))]),_:1})),[[z,f(e).loading]])])]),_:1})}}},R=B(L,[["__scopeId","data-v-a63b76e8"]]);export{R as default};
