{
  "version": "2.2",
  "language": "ru",
  "description": "Извлечение метрик (label/value) из PDF через OpenRouter PDF Inputs (mistral-ocr) для последующего RAG-mapping",
  "extraction_prompt": "Проанализируй PDF документ и извлеки ВСЕ метрики с числовым значением по шкале 1-10.\n\nАлгоритм извлечения (2 прохода):\n1. СНАЧАЛА найди ВСЕ названия метрик в тексте документа (обычно написаны ЗАГЛАВНЫМИ БУКВАМИ, сгруппированы по категориям: эмоциональные, социальные, волевые, когнитивные компетенции)\n2. ЗАТЕМ для КАЖДОЙ найденной метрики найди её числовое значение на диаграмме/графике/шкале (столбчатая диаграмма с профилем результатов)\n3. Убедись что количество извлечённых метрик совпадает с количеством метрик в тексте. Если метрика упомянута в тексте но ты не нашёл число — перепроверь диаграмму внимательнее\n\nЖёсткие правила (OCR-safe):\n- OCR может ошибаться (0/O, 1/I, 5/S, запятая/точка, разрывы строк). Если число/подпись читается НЕоднозначно — НЕ извлекай метрику.\n- НЕ придумывай значения и НЕ восстанавливай «по смыслу»: бери только явно указанные числа 1-10.\n- Извлекай метрики из таблиц, итоговых блоков, списков результатов, подписей к шкалам/диаграммам — только если значение явно присутствует как число.\n- Нормализуй число: 7,5 -> 7.5. Не добавляй единицы измерения и лишний текст.\n\nEvidence обязательно:\n- page_numbers: реальные номера страниц (1-based)\n- quotes: короткие фрагменты текста, где видны label и/или value\n{existing_metrics}\nОтвет:\n- строго JSON (без markdown)\n- соответствует output_schema",
  "output_schema": {
    "type": "object",
    "properties": {
      "metrics": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "label": { "type": "string" },
            "value": { "type": ["number", "string"] },
            "evidence": {
              "type": "object",
              "properties": {
                "page_numbers": { "type": "array", "items": { "type": "integer" } },
                "quotes": { "type": "array", "items": { "type": "string" } }
              },
              "required": ["page_numbers", "quotes"],
              "additionalProperties": false
            }
          },
          "required": ["label", "value", "evidence"],
          "additionalProperties": false
        }
      }
    },
    "required": ["metrics"],
    "additionalProperties": false
  }
}
